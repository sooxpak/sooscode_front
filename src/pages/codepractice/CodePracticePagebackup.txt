import styles from "./CodePracticePage.module.css";
import CodePracticeSidebar from "@/features/codepractice/layout/CodePracticeSidebar";
import CodePracticeSection from "@/features/codepractice/layout/CodePracticeSection";
import { usePracticeUIStore } from "../../features/codepractice/store/usePracticeUIStore";
import { usePracticeStore } from "../../features/codepractice/store/usePracticeStore";
import CodePracticeHeaderLayout from "@/features/codepractice/layout/CodePracticeHeaderLayout.jsx";
import { useEffect } from "react";
import { loadPyodideInstance } from "../../features/codepractice/utils/PyodideLoader";
import { useLoading } from "../../hooks/useLoading";
import HCJPracticeSection from "../../features/codepractice/layout/HCJPracticeSection";

export default function CodePracticePage() {

  const { isSidebarOpen } = usePracticeUIStore();
  const language = usePracticeStore((s) => s.language);  // â† ì–¸ì–´ ìƒíƒœ ê°€ì ¸ì˜¤ê¸°
  const { showLoading, hideLoading } = useLoading();
  const { htmlCode, cssCode, jsCode, setHTML, setCSS, setJS } = usePracticeStore();
  useEffect(() => {
    const init = async () => {
      try {
        showLoading();

        console.log("Code Practice Page Loading");
        await loadPyodideInstance(); 

        console.log("Pyodide Loading Success");
      } catch (err) {
        console.error("Pyodide init error:", err);
      } finally {
        hideLoading();
      }
    };

    init();
  }, []);

  
  return (
    <div className={styles.PageWrapper}>
      <CodePracticeHeaderLayout />

      <div className={styles.ContentWrapper}>
        {isSidebarOpen && <CodePracticeSidebar />}

        {/* ğŸ”¥ language === "hcj" ì´ë©´ ì™„ì „íˆ ë‹¤ë¥¸ ë ˆì´ì•„ì›ƒ */}
        {language === "hcj" ? (
          <HCJPracticeSection
            HTMLCode={htmlCode}
            CSSCode={cssCode}
            JSCode={jsCode}
            onHTMLChange={setHTML}
            onCSSChange={setCSS}
            onJSChange={setJS}
          />
        ) : (
          <CodePracticeSection /> // python / java layout
        )}
      </div>
    </div>
  );
}


              <Panel defaultSize={33.33} minSize={10}>
                <div className={styles.panelContent}>
                  <HCJCodePanelHeader HCJtitle={"CSS"}/>
                  <div className={styles.codeContainer}>
                    <HCJCodePanelContentCSS
                      code={CSSCode}
                      onChange={onCSSChange}
                    />
                  </div>
                </div>
              </Panel>
              <PanelResizeHandle className={styles.innerHandle} />
